#!/usr/bin/env electron
const { app, BrowserWindow } = require('electron')
const { readFile } = require('fs/promises')
const { resolve } = require('path')

const css = readFile(
  resolve(__dirname, '..', '..', 'config', 'custom.css'),
  'utf-8'
)

const js = readFile(
  resolve(__dirname, '..', '..', 'config', 'custom.js'),
  'utf-8'
)

app.whenReady().then(() => {
  const window = new BrowserWindow({
    titleBarStyle: 'customButtonsOnHover',
  })

  window.webContents.on('did-finish-load', async () => {
    try {
      await window.webContents.insertCSS(await css)
      await window.webContents.executeJavaScript(await js)
    } catch (err) {
      console.error({ err })
    }
  })
  window.loadURL(process.argv[2])
})
