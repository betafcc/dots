#!/usr/bin/env electron
const { app, BrowserWindow } = require('electron')
const { readFile } = require('fs/promises')
const { resolve } = require('path')

const css = readFile(
  resolve(__dirname, '..', '..', 'config', 'custom.css'),
  'utf-8'
)

const js = readFile(
  resolve(__dirname, '..', '..', 'config', 'custom.js'),
  'utf-8'
)

app.whenReady().then(() => {
  const window = new BrowserWindow({
    titleBarStyle: 'customButtonsOnHover',
  })

  window.webContents.on('did-finish-load', async () => {
    return Promise.all([
      css.then(r => window.webContents.insertCSS(r)),
      js.then(r => window.webContents.executeJavaScript(r)),
    ]).catch(console.error)
  })
  window.loadURL(process.argv[2])
})
