#!/usr/bin/env bash

#  Inputs:
#   env:
#     command 'exa'
#     command 'bat'
#     command __generic_finder


_preview() {
    if [ -d "$@" ]; then
        exa --color=always --icons --group-directories-first "$@"
    else
        bat \
            --style 'numbers,changes' \
            --color always \
            --italic-text always \
            "$@"
    fi
}


_format() {
    local prefix line
    prefix="${1}"; shift

    while read -r line; do
        if [ -d "${REPLY}" ]; then
            printf '%s/\n' "${prefix}${line}"
        else
            printf '%s\n' "${prefix}${line}"
        fi
    done
}


# export _fd_extra_args=''
# export _fzf_extra_args=''
export -f _preview
export -f _format


__generic_finder "$@"
